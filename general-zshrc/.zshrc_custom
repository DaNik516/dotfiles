# ----------------------------------------------
# Lines configured by zsh-newuser-install
HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=1000
unsetopt beep
bindkey -v
# End of lines configured by zsh-newuser-install

# The following lines were added by compinstall
zstyle :compinstall filename '/home/krit/.zshrc'

autoload -Uz compinit
compinit
# End of lines added by compinstall
# ----------------------------------------------

# ----------------------------------------------
# Export current java path to allow to use the current java version
# Note: On NixOS/Darwin, JAVA_HOME might be set globally, but this ensures dynamic resolution
export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java))))

# Export current jdtls path to allow to user the current java version
# This maps to the symlink created by home.nix
export JDTLS_BIN=$HOME/tools/jdtls/bin/jdtls
# ----------------------------------------------

# ----------------------------------------------
# FZF Styling (Universal)
export FZF_DEFAULT_OPTS=" \
  --color=fg:#cdd6f4,bg:#1e1e2e,hl:#f38ba8 \
  --color=fg+:#cdd6f4,bg+:#313244,hl+:#f38ba8 \
  --color=info:#94e2d5,prompt:#89b4fa,pointer:#f5c2e7 \
  --color=marker:#a6e3a1,spinner:#f5c2e7,header:#f9e2af,border:#45475a"
# ----------------------------------------------

# ----------------------------------------------
# Aliases

# Built in command improvement
alias cat="bat"
alias pcat="bat --style=plain"
alias sudo="sudo "
alias l="eza -lh --icons=auto"
alias ls="eza -1  --icons=auto"
alias ll="eza -lha --icons=auto --sort=name --group-directories-first"
alias ld="eza -lhD --icons=auto"
alias lt="eza --icons=auto --tree"
alias c="clear"
alias h="history"
alias which="type -a"
alias grep="grep --color=auto"
alias fgrep="fgrep --color=auto"
alias egrep="egrep --color=auto"
alias untar="tar -xvzf"
alias zshrc="source ~/.zshrc"
alias reb="reboot"
alias shut="shutdown -h now"
alias del="sudo rm -r"
alias cp="cp -i"
alias mkdir="mkdir -p"
alias aliasdelete="find . -type l -print -delete"
alias .1="cd .."
alias .2="cd ../.."
alias .3="cd ../../.."
alias .4="cd ../../../.."
alias .5="cd ../../../../.."
alias .6="cd ../../../../../.."

# Useful directory navigation
alias down="cd ~/Downloads"
alias config="cd ~/.config"
alias share="cd ~/.local/share/"
alias opt="cd /opt/"
alias home="cd /home/"
alias tmp="cd /tmp/"
alias bin="cd /bin/"
alias lib="cd /lib/"
alias etc="cd /etc/"
alias usr="cd /usr/"
alias pictures="cd ~/Pictures/"
alias videos="cd ~/Videos/"
alias doc="cd ~/Documents/"
alias temp="cd ~/Templates/"
alias dot="cd ~/dotfiles"
alias dev-projects="cd ~/developing-projects/"
alias dev-java="cd ~/developing-projects/java-projects/"
alias dev-python="cd ~/developing-projects/python-projects/"
alias dev-latex="cd ~/developing-projects/latex-projects/"
alias dev-html="cd ~/developing-projects/html-projects/"

# Useful git aliases
alias clone="git clone"
alias clonedepth1="git clone --depth=1"
alias gitkeep="find . -type d -empty -not -path './.git/*' -exec touch {}/.gitkeep \;"
alias gaall="git add -A"

# Various ssh access
alias sshtailscale="ssh krit@nicol-nas"
alias sshnasip="ssh krit@192.168.1.98"
alias sshos="ssh -l kritpio.nicol@supsi.ch linux1-didattica.supsi.ch"
alias nas-ssh="cloudflared access ssh --hostname ssh.nicolkrit.ch"

# Useful developing commands
alias rebuildmvn="cd ~/developing-projects/java-projects && mvn clean install"

# Fun commands
alias pipes1="pipes -t 1"
alias pipes2="pipes -t 2"
alias pipes3="pipes -t 3"
alias pipes4="pipes -t 4"
alias pipes5="pipes -t 5"
alias pipes6="pipes -t 6"
alias pipes7="pipes -t 7"
alias pipes8="pipes -t 8"
alias pipes9="pipes -t 9"
alias bonsailive="cbonsai -l"
cowask() {
    echo -n "What should the cow say? "
    read input
    cowsay "$input"
}

# Various
alias borg-status="journalctl -fu bormatic"

# ----------------------------------------------
# --- Git Auto Commit Functions (Current Folder Only) ---

# Ensure no old aliases conflict with these functions
unalias gac 2>/dev/null
unalias gacm 2>/dev/null

# 1. gac: Auto-commit with Date (Current folder only)
gac() {
    # Check if we are in a git repo
    if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
        echo "Error: $(pwd) is not a git repository."
        return 1
    fi

    echo "Processing repository: $(pwd)"
    git add .
    git commit -m "General-$(date +%Y-%m-%d)"
    git push
}

# 2. gacm: Interactive Commit (Current folder only)
gacm() {
    # Check if we are in a git repo
    if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
        echo "Error: $(pwd) is not a git repository."
        return 1
    fi

    # Ask for message
    echo -n "Enter commit message: "
    read msg

    if [ -z "$msg" ]; then
        echo "Aborting: Commit message cannot be empty."
        return 1
    fi

    echo "Processing repository: $(pwd)"
    git add .
    git commit -m "$msg"
    git push
}
# ----------------------------------------------

# various eval
eval "$(starship init zsh)"
eval "$(pay-respects zsh)"

# ----------------------------------------------
# Startup Splash (Fastfetch + Pokemon)
# Changed *l* to *i* (interactive) because zsh does not use 'l' flag in $-
case "$-" in
  (*i*)
    if command -v fastfetch >/dev/null 2>&1 && command -v pokemon-colorscripts >/dev/null 2>&1; then
      # Run fastfetch using the pokemon output as the raw logo
      fastfetch --data-raw "$(pokemon-colorscripts --no-title -r 1,3,6)"
    elif command -v pokemon-colorscripts >/dev/null 2>&1; then
      # Fallback: run just pokemon if fastfetch is missing
      pokemon-colorscripts --no-title -r 1,3,6
    elif command -v fastfetch >/dev/null 2>&1; then
      # Fallback: run just fastfetch
      fastfetch
    fi
    ;;
esac
# ----------------------------------------------
